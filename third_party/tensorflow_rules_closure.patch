diff --git a/tensorflow/workspace1.bzl b/tensorflow/workspace1.bzl
index 812baccbbbe..3a4d2a793dc 100644
--- a/tensorflow/workspace1.bzl
+++ b/tensorflow/workspace1.bzl
@@ -3,7 +3,7 @@
 load("@bazel_tools//tools/build_defs/repo:http.bzl", "http_archive")
 load("@com_github_grpc_grpc//bazel:grpc_deps.bzl", "grpc_deps")
 load("@com_google_benchmark//:bazel/benchmark_deps.bzl", "benchmark_deps")
-load("@io_bazel_rules_closure//closure:defs.bzl", "closure_repositories")
+load("@io_bazel_rules_closure//closure:repositories.bzl", "rules_closure_dependencies")
 load("@rules_pkg//:deps.bzl", "rules_pkg_dependencies")
 load("//third_party/android:android_configure.bzl", "android_configure")

@@ -17,7 +17,7 @@ def workspace(with_rules_cc = True):
     native.register_toolchains("@local_config_python//:py_toolchain")
     rules_pkg_dependencies()

-    closure_repositories()
+    rules_closure_dependencies()

     http_archive(
         name = "bazel_toolchains",
diff --git a/third_party/xla/xla/tsl/platform/default/build_config.bzl b/third_party/xla/xla/tsl/platform/default/build_config.bzl
index 196af9fb686..9302861c6aa 100644
--- a/third_party/xla/xla/tsl/platform/default/build_config.bzl
+++ b/third_party/xla/xla/tsl/platform/default/build_config.bzl
@@ -432,7 +432,7 @@ def py_proto_library(

     genproto_deps = []
     for dep in deps:
-        if dep != "@com_google_protobuf//:protobuf_python":
+        if dep != "@com_google_protobuf//:protobuf_python" and not dep.endswith(":protobuf_python"):
             genproto_deps.append(dep + "_genproto")
         else:
             genproto_deps.append("@com_google_protobuf//:well_known_types_py_pb2_genproto")
